---
title: "Projeto Crime Rio"
author: "Gabriela Alves"
date: "14/07/2021"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Criminalidade no Rio de Janeiro
Este estudo tem como objetivo criar um ranking com base em dados sobre a 
criminalidade do Estado do Rio de Janeiro. 
A proposta de criação deste ranking se dá por meio da Análise Fatorial por 
Componentes Principais, uma técnica não supervisionada de machine learning que
utiliza variáveis quantitativas para criar fatores que são responsáveis por 
capturar a variância compartilhada entre as variáveis e estes fatores são
ortogonais entre si.
Esta base de dados contém 53 variáveis quantitativas e pode ser encontrada no 
[link](https://www.ispdados.rj.gov.br:4432/estatistica.html). 


``` {r pacote, echo = FALSE, warning = FALSE,message = FALSE}

pacotes <- c("tidyverse","knitr","kableExtra","car","rgl","gridExtra",
             "PerformanceAnalytics","reshape2","rayshader","psych","pracma",
             "polynom","rqPen","ggrepel", "plotly","factoextra")

if(sum(as.numeric(!pacotes %in% installed.packages())) != 0){
  instalador <- pacotes[!pacotes %in% installed.packages()]
  for(i in 1:length(instalador)) {
    install.packages(instalador, dependencies = T)
    break()}
  sapply(pacotes, require, character = T)  
} else {
  sapply(pacotes, require, character = T) 
}

````
## Análise fatorial por componentes principais
A análise fatorial é uma técnica de aprendizado de máquina não supervisionada.
É uma técnica multivariada que utiliza apenas variáveis quantitativas/métricas
e essas variáveis tem um coeficiente de correlação alto entre si. 
O objetivo da análise fatorial é a extração de fatores a partir de uma matriz de
correlação gerada  dessas variáveis (e por isso tais variáveis devem ser métricas). 
Os fatores representam o comportamento conjunto das variáveis originais, e pode
ser visto como um agrupamento de variáveis.

O método de extração por componentes principais é o mais utilizado para análise
fatorial, este método extrai os fatores a partir das combinações lineares das
variáveis originais.


Esses fatores são ortogonais entre si, isto é, possui correlação 0 entre si, e 
são capazes de representar o comportamento conjunto das variáveis originais, e
pode ajudar na observação de comportamentos  que antes não eram possíveis de 
serem vistos, e portanto pode-se entender como um agrupamento de variáveis.

A análise fatorial por componentes principais tem três grandes usos:

>   1) Redução da dimensionalidade da base dados por meio do agrupamento de variáveis.
>   2) Confirmação de constructos pré determinados.
>   3) Elaboração de rankings por meio da criação de indicadores.

Sendo a elaboração de rankings uma de suas possibilidades é portanto por este
motivo que será utilizada a análise fatorial por componentes principais nesta 
base de dados, que tem por objetivo a criação de um ranking dos municípios do
Rio de Janeiro por meio de variáveis relacionadas à segurança pública.

## Ponderação arbitrária
Nesse momento faço voz para que não se confunda aqui uma variável quantitativa com 
uma qualitativa que seja expressada de forma numérica, como uma variável binária
que representa evento e não evento de algo, ou uma Escala deLikert. 
Tanto a variável binária de evento quanto a Escala de Likert são variáveis
que expressão categorias, logo não são numéricas, não é possível obter delas 
por exemplo, medidas de tendência central,dispersão ou correlação. 
E uma grande ressalva para a Escala de Likert, ainda que seja expressa em números, 
tal variável tem apenas valor semântico, e valor semântico não se mede, 
qual é a diferença numérica deruim para péssimo? Realizar uma análise fatorial
com tais variáveis resultaria em um problema de **Ponderação Arbitária**, onde 
se estará assumindo pesos numéricos para variáveis quali, onde por exemplo, se
estívéssemos falando de raça/cor, e dizemos que a cor branca é representada por
4 e a preta é 2, estamos dizendo com isso que a cor branca vale 2x mais que a 
preta, e podemos levar preconceito para nossa análise, por isso o cuidado ao
trabalhar com variáveis qualitativas.


## Apresentando a base de dados
Ao todo esta base contem 92 observações e 54 variáveis, onde apenas a primeira, 
fmun_cod é qualitativa e representa o nome dos municípios do Estado do Rio de 
Janeiro. As restantes variáveis são todas quantitativas e representam diferentes
tipos de crimes. 
Para este estudo foi selecionado os dados de 2020, que originalmente são 
apresentados no formato mensal, no entanto para observar o ano e evitar a escolha
de um mês que possa ser atípico, esses dados mensais foram somados e por isso 
temos apenas 92 observações.

```{r dados,eval = TRUE, echo = FALSE}


dados <- read.csv2("BaseMunicipioMensal.csv")
dados <- dados %>%
  filter(ano == 2020) %>%
  select(-fmun_cod,-ano, -mes,-mes_ano, -regiao, -fase)
dados <- aggregate(.~fmun, data = dados, FUN= sum)

```


https://www.geeksforgeeks.org/sum-of-rows-based-on-column-value-in-r-dataframe/
https://www.biostars.org/p/303219/
